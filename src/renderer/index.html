<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://*.youtube.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; media-src 'self' http://127.0.0.1:3000; frame-src https://*.youtube.com https://songwhip.com/ https://linkco.re/ https://fanlink.to/ https://fanlink.tv/ https://lnk.to/;">
    <title>UX Music</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div class="title-bar"></div>
    <div class="container">
        <div class="sidebar left-sidebar">
            <p>マイライブラリー</p>
            <div class="nav-links">
                <a href="#" class="nav-link active" data-view="track-view">曲</a>
                <a href="#" class="nav-link" data-view="album-view">アルバム</a>
                <a href="#" class="nav-link" data-view="playlist-view">プレイリスト</a>
                <a href="#" class="nav-link" data-view="artist-view">アーティスト</a>
            </div>
            <p>プレイリスト</p>
            <div class="playlist-header">
                <button id="create-playlist-btn" title="新規プレイリスト作成">+</button>
            </div>
            <ul id="playlist-list">
            </ul>
            <div class="sidebar-actions">
                <button id="add-network-folder-btn">+ ネットワークフォルダを追加</button>
                <button id="add-youtube-btn">+ YouTubeリンクを追加</button>
                <button id="add-youtube-playlist-btn">+ YouTubeプレイリストを追加</button>
                <button id="set-library-btn">ライブラリ場所設定</button>
                <button id="open-settings-btn">設定</button>
            </div>
        </div>
        <main class="main-content" id="drop-zone">
            <div id="track-view" class="view-container">
                <div class="search-bar">
                    <input type="text" placeholder="絞り込み検索">
                </div>
                <h1>曲</h1>
                <div id="music-list-header">
                    <div class="header-item">#</div>
                    <div class="header-item">タイトル</div>
                    <div class="header-item">アーティスト</div>
                    <div class="header-item">アルバム</div>
                    <div class="header-item">再生時間</div>
                    <div class="header-item">再生数</div>
                </div>
                <div id="music-list">
                    <div class="placeholder">
                        音楽ファイルやフォルダをここにドラッグ＆ドロップしてください
                    </div>
                </div>
            </div>

            <div id="album-view" class="view-container hidden">
                <h1>アルバム</h1>
                <div id="album-grid">
                </div>
            </div>

            <div id="playlist-view" class="view-container hidden">
                <div class="view-header">
                    <h1>プレイリスト</h1>
                    <button id="create-playlist-btn-main" class="header-button">+ 新規作成</button>
                </div>
                <div id="playlist-grid">
                </div>
            </div>

            <div id="playlist-detail-view" class="view-container hidden">
                <div class="playlist-detail-header">
                <div class="playlist-art-collage">
                </div>
                    <div class="playlist-info">
                        <h1 id="p-detail-title">プレイリスト名</h1>
                        <p id="p-detail-meta">メタ情報</p>
                        <div class="p-detail-actions">
                            <button class="play-all-btn">▶ すべて再生</button>
                        </div>
                    </div>
                </div>
                <div id="p-detail-list-header" class="music-list-header">
                </div>
                <div id="p-detail-list" class="music-list">
                </div>
            </div>
        </main>
        <div id="resizer" class="resizer-vertical"></div>
        <div class="sidebar right-sidebar">
            <div id="now-playing-container">
                    <div id="now-playing-artwork-container">
                        <img src="./assets/default_artwork.png" alt="Now Playing Artwork">
                    </div>
                <div id="now-playing-details">
                    <h2 id="now-playing-title">曲を選択してください</h2>
                    <p id="now-playing-artist"></p>
                    <div id="hub-link-container"></div>
                </div>
            </div>
        </div>
    </div>
    <footer class="playback-bar">
        <div class="playback-controls">
            <button id="shuffle-btn" class="playback-mode-btn" title="シャッフル">🔀</button>
            <button id="prev-btn">⏮</button>
            <button id="play-pause-btn">▶</button>
            <button id="next-btn">⏭</button>
            <button id="loop-btn" class="playback-mode-btn" title="リピート">🔁</button>
        </div>
        <div class="progress-container">
            <span id="current-time">0:00</span>
            <input type="range" id="progress-bar" value="0" step="1">
            <span id="total-duration">0:00</span>
        </div>
        <div class="volume-container">
            <span id="volume-icon">🔊</span>
            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
        </div>
        <div class="device-container">
            <select id="audio-output-select"></select>
        </div>
    </footer>
    <div id="modal-overlay" class="hidden">
        <div id="modal">
            <h3>ネットワークフォルダのパス</h3>
            <p>ネットワーク共有フォルダのパスを入力してください。</p>
            <input type="text" id="modal-input" placeholder="\\ServerName\ShareName">
            <div class="modal-buttons">
                <button id="modal-cancel-btn">キャンセル</button>
                <button id="modal-ok-btn">OK</button>
            </div>
        </div>
    </div>
    <div id="loading-overlay" class="hidden">
        <div class="spinner"></div>
        <p class="loading-text">ライブラリをスキャン中...</p>
    </div>

<div id="settings-modal-overlay" class="hidden">
    <div id="settings-modal">
        <h2>設定</h2>
        <div class="setting-item">
            <h4>YouTube再生モード</h4>
            <p>YouTubeリンク追加時の動作を選択します。</p>
            <div class="radio-group">
                <label>
                    <input type="radio" name="youtube-mode" value="download" checked>
                    <strong>ダウンロードモード (推奨)</strong>
                    <small>動画をPCに保存します。オフライン再生や再生先の変更が可能です。</small>
                </label>
                <label>
                    <input type="radio" name="youtube-mode" value="stream">
                    <strong>ストリーミングモード</strong>
                    <small>すぐに再生できますが、再生先の変更はできず、音と映像が同期されます。</small>
                </label>
                            <label>
                <input type="radio" name="youtube-quality" value="full" checked>
                <strong>最高品質</strong>
                <small>映像と音声をダウンロードします。(MP4)</small>
            </label>
            <label>
                <input type="radio" name="youtube-quality" value="audio_only">
                <strong>音声のみ (省データ)</strong>
                <small>音声のみをダウンロードし、通信量と保存容量を節約します。(M4A)</small>
            </label>
            </div>
        </div>
        <div class="modal-buttons">
            <button id="settings-ok-btn">OK</button>
        </div>
    </div>
</div>


    <div id="youtube-player-container" style="position: absolute; top: -9999px; left: -9999px;"></div>
    
    <video id="main-player" style="display: none;"></video>
    <script type="module" src="./renderer.js"></script>

</body>
</html>
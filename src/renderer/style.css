/* (省略せずに全スタイルを記載) */
body, html { margin: 0; padding: 0; height: 100vh; width: 100vw; background-color: #121212; color: #ffffff; font-family: 'Segoe UI', Meiryo, sans-serif; overflow: hidden; display: flex; flex-direction: column; }
.title-bar { height: 32px; background-color: #282828; width: 100%; -webkit-app-region: drag; }
.container { display: flex; flex-grow: 1; height: calc(100% - 122px); }
.sidebar { background-color: #000000; padding: 20px; box-sizing: border-box; }
.left-sidebar { width: 220px; flex-shrink: 0; display: flex; flex-direction: column; }
.nav-links { margin-top: 10px; margin-bottom: 20px; }
.nav-link { display: block; padding: 10px 12px; color: #b3b3b3; text-decoration: none; border-radius: 4px; font-weight: bold; }
.nav-link:hover { color: #fff; background-color: #282828; }
.nav-link.active { color: #fff; background-color: #282828; }
.sidebar-actions { margin-top: auto; }
#add-network-folder-btn, #add-youtube-btn, #add-youtube-playlist-btn, #set-library-btn, #open-settings-btn { width: 100%; padding: 10px; background-color: #282828; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; text-align: left; margin-top: 8px; }
#add-network-folder-btn:hover, #add-youtube-btn:hover, #add-youtube-playlist-btn:hover, #set-library-btn:hover, #open-settings-btn:hover { background-color: #3a3a3a; }
.main-content { flex-grow: 1; padding: 20px; overflow-y: auto; }
.right-sidebar {
    width: 300px;
    min-width: 240px;
    max-width: 600px;
    flex-shrink: 0;
    border-left: 1px solid #282828;
    padding: 24px;
    /* ★★★ 修正箇所: right-sidebarもflexコンテナにする ★★★ */
    display: flex;
    flex-direction: column;
}
.resizer-vertical {
    width: 5px;
    cursor: col-resize;
    background-color: #000;
    flex-shrink: 0;
    border-left: 1px solid #282828;
    border-right: 1px solid #282828;
    transition: background-color 0.2s;
}
.resizer-vertical:hover {
    background-color: #1DB954;
}
#now-playing-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
    /* ★★★ 修正箇所: heightがあふれないようにmin-heightを追加 ★★★ */
    min-height: 0;
}
#now-playing-artwork-container {
    width: 100%;
    aspect-ratio: 1 / 1;
    border-radius: 8px;
    background-color: #333;
    box-shadow: 0 4px 60px rgba(0, 0, 0, 0.5);
    margin-bottom: 24px;
    overflow: hidden;
    transition: aspect-ratio 0.3s ease;
    flex-shrink: 0;
}
#now-playing-artwork-container.video-mode {
    aspect-ratio: 16 / 9;
}
#now-playing-artwork-container img,
#now-playing-artwork-container iframe,
#now-playing-artwork-container video {
    width: 100%;
    height: 100%;
    border: none;
    object-fit: cover;
}
#now-playing-details { width: 100%; text-align: left; flex-shrink: 0; }
#now-playing-title { font-size: 24px; font-weight: 700; color: #fff; margin: 0 0 8px 0; }
#now-playing-artist { font-size: 16px; font-weight: 400; color: #b3b3b3; margin: 0; }
#drop-zone { border: 2px dashed transparent; transition: border-color 0.3s; }
#drop-zone.drag-over { border-color: #1DB954; }
.placeholder { display: flex; justify-content: center; align-items: center; height: 200px; color: #888; font-size: 1.2em; }
#music-list-header, #p-detail-list-header, #a-detail-list-header {
    display: flex;
    padding: 0 16px;
    color: #888;
    border-bottom: 1px solid #282828;
    font-size: 0.9em;
}

#music-list-header .header-item:nth-child(1),
#p-detail-list-header .header-item:nth-child(1),
#a-detail-list-header .header-item:nth-child(1) { flex: 0 0 50px; }
#music-list-header .header-item:nth-child(2),
#p-detail-list-header .header-item:nth-child(2),
#a-detail-list-header .header-item:nth-child(2) { flex: 5; }
#music-list-header .header-item:nth-child(3),
#p-detail-list-header .header-item:nth-child(3),
#a-detail-list-header .header-item:nth-child(3) { flex: 3; }
#music-list-header .header-item:nth-child(4),
#p-detail-list-header .header-item:nth-child(4),
#a-detail-list-header .header-item:nth-child(4) { flex: 3; }
#music-list-header .header-item:nth-child(5),
#p-detail-list-header .header-item:nth-child(5),
#a-detail-list-header .header-item:nth-child(5) { flex: 1; text-align: right; }
#music-list-header .header-item:nth-child(6),
#p-detail-list-header .header-item:nth-child(6),
#a-detail-list-header .header-item:nth-child(6) { flex: 1; text-align: right; }

#music-list { overflow-y: auto; height: calc(100% - 100px); }
.song-item { display: flex; align-items: center; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
.song-item:hover { background-color: #282828; }

#music-list .song-index,
#p-detail-list .song-index,
#a-detail-list .song-index { flex: 0 0 50px; color: #888; }
#music-list .song-title,
#p-detail-list .song-title,
#a-detail-list .song-title { flex: 5; display: flex; align-items: center; }
#music-list .song-artist,
#p-detail-list .song-artist,
#a-detail-list .song-artist { flex: 3; }
#music-list .song-album,
#p-detail-list .song-album,
#a-detail-list .song-album { flex: 3; }
#music-list .song-duration,
#p-detail-list .song-duration,
#a-detail-list .song-duration { flex: 1; text-align: right; }
#music-list .song-play-count,
#p-detail-list .song-play-count,
#a-detail-list .song-play-count { flex: 1; text-align: right; padding-right: 10px; }

.artwork-small { width: 40px; height: 40px; margin-right: 16px; border-radius: 4px; background-color: #333; object-fit: cover; }
.song-item.playing { background-color: #3a3a3a; color: #1DB954; }
.playback-bar { display: flex; flex-direction: row; justify-content: space-between; align-items: center; padding: 8px 20px; box-sizing: border-box; border-top: 1px solid #282828; background-color: #181818; height: 90px; width: 100%; flex-shrink: 0; }
.playback-controls { display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-basis: 300px; }
.playback-controls button { background: none; border: none; color: #b3b3b3; font-size: 20px; cursor: pointer; margin: 0 10px; transition: color 0.2s; }
.playback-controls button:hover { color: #fff; }
#play-pause-btn { font-size: 28px; width: 40px; height: 40px; border: 1px solid #b3b3b3; border-radius: 50%; display: flex; justify-content: center; align-items: center; }
#play-pause-btn:hover { border-color: #fff; }
.playback-mode-btn { 
    font-size: 18px; 
    position: relative; 
}
.playback-mode-btn.active { 
    color: #1DB954; 
}
.playback-mode-btn.active::after {
    content: '';
    position: absolute;
    bottom: 5px;
    left: 50%;
    transform: translateX(-50%);
    width: 5px;
    height: 5px;
    background-color: #1DB954;
    border-radius: 50%;
    box-shadow: 0 0 2px rgba(0,0,0,0.5);
}
.playback-mode-btn#loop-btn.loop-one::after {
    content: '1';
    bottom: 0px;
    left: 50%;
    transform: translateX(-50%);
    width: 14px;
    height: 14px;
    line-height: 14px;
    font-size: 10px;
    font-weight: bold;
    text-align: center;
    color: #121212;
    background-color: #1DB954;
    border-radius: 50%;
}
.progress-container { flex-grow: 1; margin: 0 20px; display: flex; align-items: center; gap: 15px; font-size: 0.8em; color: #aaa; }
#progress-bar { flex-grow: 1; -webkit-appearance: none; width: 100%; height: 4px; background: #4d4d4d; outline: none; border-radius: 2px; cursor: pointer; }
#progress-bar::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 14px; height: 14px; background: #fff; border-radius: 50%; }
.volume-container { display: flex; align-items: center; width: 180px; }
.volume-container #volume-icon { margin-right: 10px; font-size: 20px; cursor: pointer; }
#volume-slider { -webkit-appearance: none; width: 100%; height: 4px; background: #4d4d4d; outline: none; border-radius: 2px; cursor: pointer; }
#volume-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 14px; height: 14px; background: #fff; border-radius: 50%; }
.device-container { margin-left: 20px; }
#audio-output-select { background-color: #282828; color: #fff; border: 1px solid #888; border-radius: 4px; padding: 5px; min-width: 150px; }
.view-container.hidden { display: none; }
.view-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
.view-header h1 { margin: 0; }
.header-button { background-color: #333; color: #fff; border: none; border-radius: 20px; padding: 8px 16px; font-size: 14px; font-weight: bold; cursor: pointer; }
.header-button:hover { background-color: #444; }

#album-grid, #playlist-grid, #artist-grid, .album-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 24px;
}

.album-grid-item, .playlist-grid-item { background-color: #181818; border-radius: 8px; padding: 16px; cursor: pointer; transition: background-color 0.2s; }
.album-grid-item:hover, .playlist-grid-item:hover { background-color: #282828; }
.album-artwork { width: 100%; aspect-ratio: 1 / 1; border-radius: 4px; object-fit: cover; background-color: #333; margin-bottom: 12px; }
.album-title, .playlist-title { color: #fff; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.album-artist { color: #b3b3b3; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

#modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; }
#modal-overlay.hidden { display: none; }
#modal { background-color: #282828; padding: 25px; border-radius: 8px; width: 100%; max-width: 500px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
#modal h3 { margin-top: 0; }
#modal p { color: #aaa; font-size: 14px; }
#modal-input { width: 100%; padding: 10px; box-sizing: border-box; background-color: #121212; border: 1px solid #535353; color: #fff; border-radius: 4px; margin-top: 10px; margin-bottom: 20px; }
.modal-buttons { text-align: right; }
.modal-buttons button { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
#modal-cancel-btn { background-color: transparent; color: #fff; }
#modal-cancel-btn:hover { background-color: #3a3a3a; }
#modal-ok-btn { background-color: #1DB954; color: #fff; margin-left: 10px; }
#modal-ok-btn:hover { background-color: #1ed760; }
#loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; color: #fff; }
#loading-overlay.hidden { display: none; }
.spinner { border: 4px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top: 4px solid #fff; width: 50px; height: 50px; animation: spin 1s linear infinite; margin-bottom: 20px; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.loading-text { font-size: 1.2em; font-weight: bold; }

.detail-header {
    display: flex;
    align-items: flex-end;
    gap: 24px;
    margin-bottom: 30px;
}
.detail-art-img {
    width: 200px;
    height: 200px;
    flex-shrink: 0;
    box-shadow: 0 4px 60px rgba(0,0,0,0.5);
    background-color: #333;
    object-fit: cover;
    display: flex;
    align-items: center;
    justify-content: center;
}
.detail-info h1 {
    font-size: 32px;
    font-weight: 900;
    margin: 0 0 16px 0;
}
.detail-info p {
    color: #b3b3b3;
    margin: 0 0 16px 0;
}
.play-all-btn {
    background-color: #1DB954;
    color: #fff;
    border: none;
    border-radius: 50px;
    padding: 12px 24px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
}

#p-detail-list-header, #p-detail-list {
    padding: 0;
}

#open-settings-btn { width: 100%; padding: 10px; background-color: #282828; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; text-align: left; margin-top: 8px; }
#open-settings-btn:hover { background-color: #3a3a3a; }
#settings-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; }
#settings-modal-overlay.hidden { display: none; }
#settings-modal { background-color: #282828; padding: 25px; border-radius: 8px; width: 100%; max-width: 500px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
#settings-modal h2 { margin-top: 0; }
#settings-modal .setting-item { margin-top: 20px; }
#settings-modal .radio-group label { display: block; padding: 10px; border-radius: 4px; cursor: pointer; margin-top: 5px; }
#settings-modal .radio-group label:hover { background-color: #3a3a3a; }
#settings-modal .radio-group input { margin-right: 10px; }
#settings-modal .radio-group small { color: #b3b3b3; display: block; margin-left: 25px; }
#youtube-player-container {
    width: 100%;
    height: 100%;
}
.playlist-artwork-container {
    width: 100%;
    aspect-ratio: 1 / 1;
    border-radius: 4px;
    margin-bottom: 12px;
    background-color: #282828;
    overflow: hidden;
}
.playlist-artwork-container.grid-collage {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
}
.playlist-artwork-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    min-width: 0;
}
.playlist-art-collage.grid-collage {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
}
.playlist-art-collage > img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.collage-img-wrapper {
    overflow: hidden;
    width: 100%;
    height: 100%;
}
.collage-img-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.hub-link-button {
    width: 100%;
    height: 100%;
    background-color: #282828;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: background-color 0.2s;
    padding: 20px;
    box-sizing: border-box;
    text-align: center;
}
.hub-link-button:hover {
    background-color: #3a3a3a;
}
.hub-link-icon {
    font-size: 48px;
    margin-bottom: 16px;
}
.hub-link-text {
    font-size: 16px;
    font-weight: bold;
    color: #fff;
    line-height: 1.4;
}
#hub-link-container {
    margin-top: 20px;
    width: 100%;
}
.hub-link-button-small {
    width: 100%;
    padding: 12px;
    background-color: #333;
    color: #fff;
    border: 1px solid #555;
    border-radius: 20px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s, border-color 0.2s;
}
.hub-link-button-small:hover {
    background-color: #444;
    border-color: #777;
}

.artist-grid-item {
    background-color: #181818;
    border-radius: 8px;
    padding: 16px;
    cursor: pointer;
    transition: background-color 0.2s;
    text-align: center;
}
.artist-grid-item:hover {
    background-color: #282828;
}
.artist-artwork {
    width: 100%;
    aspect-ratio: 1 / 1;
    border-radius: 50%;
    object-fit: cover;
    background-color: #333;
    margin-bottom: 12px;
    box-shadow: 0 4px 30px rgba(0,0,0,0.4);
}
.artist-name {
    color: #fff;
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.artist-detail-art-round {
    border-radius: 50%;
}
#artist-detail-view h2 {
    margin-top: 40px;
}

#notification-toast {
    position: fixed;
    bottom: 110px;
    right: 20px;
    background-color: #282828;
    color: #fff;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    z-index: 3000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
    transform: translateY(20px);
}
#notification-toast.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}
#notification-toast.hidden {
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
}
.song-item.dragging {
    opacity: 0.5;
    background: #535353;
}
.context-menu {
    position: fixed;
    z-index: 10000;
    background-color: #282828;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
    padding: 5px 0;
    min-width: 150px;
}
.context-menu-item {
    padding: 10px 15px;
    color: #b3b3b3;
    cursor: pointer;
    font-size: 14px;
}
.context-menu-item:hover {
    background-color: #3a3a3a;
    color: #fff;
}
#lyrics-container {
    width: 100%;
    flex-grow: 1;
    margin-top: 24px;
    display: flex;
    min-height: 0; /* ★★★ 修正箇所 ★★★ */
}
#lyrics-view {
    width: 100%;
    overflow-y: auto;
    text-align: center;
    font-size: 16px;
    line-height: 2.2;
    color: #b3b3b3;
    scroll-behavior: smooth;
    scrollbar-width: thin;
    scrollbar-color: #555 #282828;
}
#lyrics-view p {
    margin: 0;
    padding: 2px 10px;
    border-radius: 4px;
    transition: color 0.3s, background-color 0.3s;
}
#lyrics-view p.active {
    color: #fff;
    font-weight: bold;
    background-color: rgba(255, 255, 255, 0.1);
}
.no-lyrics {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #888;
}